# -*- coding: utf-8 -*-
"""jaroflove

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hnGIRppBDbYnY214WYh6b9xcROsJC6nt
"""

import streamlit as st
import matplotlib.pyplot as plt
import matplotlib.patches as patches
import time

# Function to display and animate the "cylinder" filling
def display_cylinder(fill_height):
    # Define cylinder dimensions
    cylinder_width = 2  # Width of the cylinder
    cylinder_height = 4  # Height of the cylinder

    # Create a figure and axis for the cylinder
    fig, ax = plt.subplots(figsize=(6, 8))

    # Draw the cylinder (as a rectangle)
    ax.add_patch(patches.Rectangle((0, 0), cylinder_width, cylinder_height, linewidth=2, edgecolor='black', facecolor='lightgray'))

    # Draw the filled part of the cylinder (in red)
    ax.add_patch(patches.Rectangle((0, 0), cylinder_width, fill_height, linewidth=0, edgecolor='black', facecolor='red'))

    # Set the limits of the plot to match the cylinder size
    ax.set_xlim(0, cylinder_width)
    ax.set_ylim(0, cylinder_height)

    # Remove axes for a cleaner look
    ax.axis('off')

    # Return the figure
    return fig

# Function to animate the cylinder gradually to 100%
def slowly_fill_cylinder(start_fill_height):
    target_fill_height = 4  # 100% fill corresponds to the cylinder height of 4
    increment = 0.1  # Small increments for smooth animation

    # Create a placeholder for the animation
    cylinder_placeholder = st.empty()

    # Gradually increase the fill height
    current_fill_height = start_fill_height
    while current_fill_height < target_fill_height:
        # Render the cylinder with the current fill height
        fig = display_cylinder(current_fill_height)
        cylinder_placeholder.pyplot(fig)

        # Increment the fill height
        current_fill_height += increment

        # Pause briefly to create animation effect
        time.sleep(0.1)

    # Ensure the final frame shows a fully filled cylinder
    fig = display_cylinder(target_fill_height)
    cylinder_placeholder.pyplot(fig)

# Function for final message
def final_message(correct_answers, total_questions):
    if correct_answers == total_questions:
        st.write("The cylinder is full of love!")
        st.write(f"You answered {correct_answers}/{total_questions} correctly.")
        st.write("Evidently, you are always right. <3")
    else:
        st.write("The cylinder is not full of love!")
        st.write(f"You answered {correct_answers}/{total_questions} correctly.")
        st.write("But no matter what, you are always right. <3")
        # Trigger the slow fill animation
        start_fill_height = (correct_answers / total_questions) * 4
        slowly_fill_cylinder(start_fill_height)

# Main app logic
def main():
    # List of questions, choices, and correct answers
    questions = [
        {"question": "What do I love most about you?", "choices": ["Humor", "Sex", "Affirmation", "Calling me out"], "correct_answer": "Calling me out"},
        {"question": "What do you think, I would choose as your favorite food?", "choices": ["Buldwak Ramen", "Thai soup", "Pasta", "Borger"], "correct_answer": "Buldwak Ramen"},
        {"question": "Where did we first meet?", "choices": ["Dream", "Cafe", "2 no. gate", "Your garage"], "correct_answer": "Cafe"},
        {"question": "What do you think, I would choose as your favorite movie from the options below?", "choices": ["Tangled", "Howls Moving Castle", "Whisper of the Heart", "From up on poppy hill"], "correct_answer": "Tangled"},
        {"question": "What's your dream vacation destination, I would choose?", "choices": ["Maldives", "Okinawa", "Bali", "Malaysia"], "correct_answer": "Bali"},
        {"question": "What our favorite hobby?", "choices": ["Reading", "Cooking", "Talking", "Laying down doing nothing"], "correct_answer": "Talking"},
        {"question": "Which animal I would bring home that you would love?", "choices": ["Dog", "Cat", "Hamster", "Tiger"], "correct_answer": "Cat"},
        {"question": "What's our favorite season?", "choices": ["Winter", "Spring", "Summer", "Autumn"], "correct_answer": "Spring"},
        {"question": "What type of music do I think, you like?", "choices": ["Pop", "Rock", "Classical", "Indie"], "correct_answer": "Indie"},
        {"question": "What do you think, I would choose as your favorite movie from the options below?", "choices": ["The Notebook", "Little Women", "Shrek", "Pride and Prejudice"], "correct_answer": "Little Women"},
    ]
    
    # Initialize session state to track the current question and the number of correct answers
    if "question_index" not in st.session_state:
        st.session_state.question_index = 0
    if "correct_answers" not in st.session_state:
        st.session_state.correct_answers = 0

    # Get the current question
    current_question = questions[st.session_state.question_index]

    # Display the current question
    st.write(current_question["question"])
    user_choice = st.radio("Choose an answer:", current_question["choices"], key=f"question_{st.session_state.question_index}")

    # Proceed to the next question when the "Next" button is pressed
    if st.button("Next"):
        # Check if the user's choice is correct
        if user_choice == current_question["correct_answer"]:
            st.session_state.correct_answers += 1

        # Move to the next question
        if st.session_state.question_index < len(questions) - 1:
            st.session_state.question_index += 1
        else:
            # Display the final message and animate the cylinder
            final_message(st.session_state.correct_answers, len(questions))

if __name__ == "__main__":
    main()
