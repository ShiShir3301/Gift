# -*- coding: utf-8 -*-
"""jaroflove

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hnGIRppBDbYnY214WYh6b9xcROsJC6nt
"""

import streamlit as st
import matplotlib.pyplot as plt
import matplotlib.patches as patches

# Function to display and animate the "cylinder" filling
def animate_cylinder(correct_answers, total_questions):
    # Define cylinder dimensions
    cylinder_width = 2  # Width of the cylinder
    cylinder_height = 4  # Height of the cylinder
    fill_height = (correct_answers / total_questions) * cylinder_height  # Calculate fill height

    # Create a figure and axis for the cylinder
    fig, ax = plt.subplots(figsize=(6, 8))

    # Draw the cylinder (as a rectangle)
    ax.add_patch(patches.Rectangle((0, 0), cylinder_width, cylinder_height, linewidth=2, edgecolor='black', facecolor='lightgray'))

    # Draw the filled part of the cylinder (in red)
    ax.add_patch(patches.Rectangle((0, 0), cylinder_width, fill_height, linewidth=0, edgecolor='black', facecolor='red'))

    # Set the limits of the plot to match the cylinder size
    ax.set_xlim(0, cylinder_width)
    ax.set_ylim(0, cylinder_height)

    # Remove axes for a cleaner look
    ax.axis('off')

    # Display the plot
    st.pyplot(fig)

# Function to handle the question and answer logic
def ask_question(question, choices, correct_answer, question_index, correct_answers, questions):
    st.write(question)
    user_choice = st.radio("Choose an answer:", choices, key=f"question_{question_index}")

    return user_choice

# Function for final message and the cylinder's completion
def final_message(correct_answers, total_questions):
    if correct_answers == total_questions:
        st.write("The cylinder is full of love!")
        st.write(f"You answered {correct_answers}/{total_questions} correctly.")
        st.write("Evidently, you are always right. <3")
    else:
        st.write("The cylinder is not full of love!")
        st.write(f"You answered {correct_answers}/{total_questions} correctly.")
        st.write("But no matter what, you are always right. <3")
        # Animate the cylinder to 100% fill up
        animate_cylinder(total_questions, total_questions)

# Main app logic
def main():
    # List of questions, choices, and correct answers
    questions = [
        {"question": "What do I love most about you?", "choices": ["Humor", "Sex", "Affirmation", "Calling me out"], "correct_answer": "Calling me out"},
        {"question": "What do you think, I would choose as your favorite food?", "choices": ["Buldwak Ramen", "Thai soup", "Pasta", "Borger"], "correct_answer": "Buldwak Ramen"},
        {"question": "Where did we first meet?", "choices": ["Dream", "Cafe", "2 no. gate", "Your garage"], "correct_answer": "Cafe"},
        {"question": "What do you think, I would choose as your favorite movie from the options below?", "choices": ["Tangled", "Howls Moving Castle", "Whisper of the Heart", "From up on poppy hill"], "correct_answer": "Tangled"},
        {"question": "What's your dream vacation destination, I would choose?", "choices": ["Maldives", "Okinawa", "Bali", "Malaysia"], "correct_answer": "Bali"},
        {"question": "What our favorite hobby?", "choices": ["Reading", "Cooking", "Talking", "Laying down doing nothing"], "correct_answer": "Talking"},
        {"question": "Which animal I would bring home that you would love?", "choices": ["Dog", "Cat", "Hamster", "Tiger"], "correct_answer": "Cat"},
        {"question": "What's our favorite season?", "choices": ["Winter", "Spring", "Summer", "Autumn"], "correct_answer": "Spring"},
        {"question": "What type of music do I think, you like?", "choices": ["Pop", "Rock", "Classical", "Indie"], "correct_answer": "Indie"},
        {"question": "What do you think, I would choose as your favorite movie from the options below?", "choices": ["The Notebook", "Little Women", "Shrek", "Pride and Prejudice"], "correct_answer": "Little Women"},
    ]

    # Initialize session state to track the current question and the number of correct answers
    if "question_index" not in st.session_state:
        st.session_state.question_index = 0
    if "correct_answers" not in st.session_state:
        st.session_state.correct_answers = 0
    if "user_choice" not in st.session_state:
        st.session_state.user_choice = None

    # Get the current question
    current_question = questions[st.session_state.question_index]

    # Ask the current question
    user_choice = ask_question(current_question['question'], current_question['choices'], current_question['correct_answer'], st.session_state.question_index, st.session_state.correct_answers, questions)

    # Show the answer only when the user presses "Next"
    answer_revealed = False
    if user_choice:
        if st.button("Next", key=f"next_{st.session_state.question_index}"):
            if user_choice == current_question['correct_answer']:
                st.session_state.correct_answers += 1
                st.success(f"Correct! The answer is: {current_question['correct_answer']}")
            else:
                st.error(f"Oops! The correct answer was: {current_question['correct_answer']}")
            answer_revealed = True

            # Move to the next question
            if st.session_state.question_index < len(questions) - 1:
                st.session_state.question_index += 1
            else:
                # Final message once all questions are answered
                final_message(st.session_state.correct_answers, len(questions))
                st.session_state.question_index = 0  # Reset for potential replay

    # Display the cylinder animation based on the correct answers so far
    if answer_revealed:
        animate_cylinder(st.session_state.correct_answers, len(questions))

if __name__ == "__main__":
    main()